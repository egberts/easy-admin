#
# File: 804-obscure-keystroke-timing.conf
# Path: /etc/ssh/sshd_config.d
# Title: Obscure keystroke timing
# Description:
#
#   'ObscureKeystrokeTiming' enables mitigation against
#   keystroke-timing analysis attacks for interactive SSH
#   client sessions.
#
#   Specifies whether and how keystroke timing obfuscation is
#   applied for interactive SSH sessions. 
#   The default is 20 milliseconds.
#
#
#   When enabled, the SSH client introduces random delays
#   and packet padding to keystroke traffic, making it more
#   difficult for an observer to infer typed input (such as
#   passwords or commands) based on packet timing.
#
#   This option accepts either a boolean or a numeric value:
#
#     no            Disable keystroke timing obfuscation
#     yes           Enable obfuscation using the default delay
#     0–1000        Maximum added delay in milliseconds
#
#   The numeric form specifies the upper bound (in
#   milliseconds) of the random delay applied to keystrokes.
#
#   This option may slightly increase latency and bandwidth
#   usage and is primarily useful for interactive sessions
#   on untrusted or monitored networks.
#
#   It has no effect on non-interactive connections.
#
#   This is a client-side option and may be used in:
#     - ssh_config
#     - files included from ssh_config.d
#
#   It is not valid in sshd_config.
#
#   Recommended Usage Pattern:
#
#       # Apply keystroke timing obfuscation only for high-risk connections
#       Match tagged high-risk
#           ObscureKeystrokeTiming 100
#
#   ... and how the tag might be set elsewhere:
#
#       Host *.example.net
#           Tag high-risk
#
#   Practical advice (off the record)
#
#       20 ms (default)  -> reasonable baseline
#       50–100 ms        -> noticeably stronger obfuscation, still usable
#       >200 ms          -> starts to feel laggy for shells
#       0                -> technically enabled, but minimal effect
#
#
# CLI option: -o ObscureKeystrokeTiming=<'yes'|'no'|'false'|'true'|<0-1000>>
# Introduced: 9.5
# Obsoleted:
# Process context: server daemon
# Network Stage: Key exchange (KEX) negotiation
# Dispatch: n/a
# Channel name: kex (pre-channel)
# Channel type: n/a
# Control type: n/a
# Mode: n/a
# Variable: options.obscure_keystroke_timing_interval
# Source (read): obfuscate_keystroke_timing()/client_wait_until_can_do_something()/client_loop()/ssh_session2()/main()
# Source (write): process_config_line_depth()/process_config_line()/main()
# Source (write): initialize_options()/main()
# Source (write): fill_default_options()/main()
#
ObscureKeystrokeTiming 20
