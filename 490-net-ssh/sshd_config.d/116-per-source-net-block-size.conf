#
# File: 116-per-source-net-block-size.conf
# Path: /etc/ssh/ (sshd_config) or /etc/ssh/sshd_config.d/*.conf
# Title: Per-source connection rate limiting
# Description:
#
#   'PerSourceNetBlockSize' directive defines
#   network-based aggregation applied per client
#   sources.
#
#   Syntax:
#
#       PerSourceNetBlockSize <bits-for-ipv4>
#       PerSourceNetBlockSize <bits-for-ipv4>:<bits-for-ipv6>
#
#   Specifies the number of <bits-for-ipv4> of IPv4 source
#   address that are grouped together for the purposes of
#   applying 'PerSourceMaxStartups' limits.
#
#   Values for IPv4, and optionally for IPv6 may be
#   specified, separated by a colon.
#
#   The default is '32:128', which means each address family
#   is considered individually.
#
#   Introduced in OpenSSH v8.5-p1
#
#   Warnings:
#     - Incorrect values may amplify denial-of-service effects.
#
# CLI option: -oPerSourceNetBlockSize=32:128
# Introduced: 9.8
# Obsoleted:
# Matchable: No
# Process context: server daemon (sshd)
# Network stage: pre-authentication
# Dispatch: SSH2_MSG_CHANNEL_OPEN
# Dispatch: SSH2_MSG_USERAUTH_REQUEST
# Control type: n/a
# Channel name type: tun@openssh.com
# Channel type: n/a
# Mode:
# Variable: options.per_source_masklen_ipv4
# Variable: options.per_source_masklen_ipv6
# Source (read): initialize_server_options()/parse_server_match_config()/main()
# Source (read): initialize_server_options()/parse_server_match_config()/getpwnamallow()/input_userauth_request()/dispatch[]/ssh_dispatch_get()
# Source (read): initialize_server_options()/parse_server_match_config()/getpwnamallow()/input_userauth_request()/input_service_request()/do_authentication2()/main()
# Source (write): fill_default_server_options()/main()
# Source (write): process_server_config_line_depth()/process_server_config_line()/main()
#
PerSourceNetBlockSize 32:128

