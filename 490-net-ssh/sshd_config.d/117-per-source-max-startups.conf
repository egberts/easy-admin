#
# File: 117-per-source-max-startups.conf
# Path: /etc/ssh/sshd_config.d
# Title: Maximum startups by source IP address
# Description:
#
#   Implements limitation of a maximum startup of
#   failed authentication per source IP address.
#
#   Does the following:
#     *  Mitigating DoS Attacks: By limiting the number of
#        unauthenticated connections from a single source,
#        you can prevent denial-of-service attacks that attempt
#        to exhaust server resources.
#
#   Rate-Limiting: This setting can be used to control the rate
#   at which clients can initiate connections, helping to
#   manage server load.
#
# Considerations
#
#   Compatibility: Ensure that the per-source limit aligns
#   with your network architecture and does not inadvertently
#   block legitimate users.
#
#   Testing: After configuring this setting, monitor the
#   server logs to ensure that it behaves as expected and
#   does not interfere with normal operations.
#
#   The default is 'none'.
#
#   Introduced in OpenSSH v8.2-p1
#
# CLI option: -oPerSourceNaxStartups=5
# CLI option: -oPerSourceNaxStartups=none
# Process context: server daemon
# Network stage: Session setup
# Dispatch: SSH2_MSG_CHANNEL_OPEN
# Channel type: tun@openssh.com
# Mode: SSH_TUNMODE_
# Variable: options.per_source_max_startups
# Variable: max_persource
# Source (read): server_listen()/
# Source (read): srclimit_check_allow()/drop_connection()/server_accept_loop()/main()
# Source (write): fill_default_server_options()/main()/servconf.c
# Source (write): process_server_config_line_depth()/process_server_config_line()/main()/servconf.c
# Source (write): dump_config()/servconf.c
#
#
PerSourceMaxStartups 5

